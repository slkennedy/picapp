!function(){"use strict";window.App={},App.Models={},App.Views={},App.Collections={},App.Models.Photo=Parse.Object.extend("Photo"),App.Router=Parse.Router.extend({initialize:function(){this.render()},render:function(){},routes:{"":"logIn",login:"logIn",create:"create",logout:"logout",newPost:"newPost",yourPhotos:"yourPhotos",allPics:"allPics",":username":"userphotos"},logIn:function(){$(".main-section").empty(),new App.Views.LoginView},create:function(){$(".main-section").empty(),new App.Views.CreateAccountView},logout:function(){$(".main-section").empty(),new App.Views.LogoutView},newPost:function(){$(".main-section").empty(),new App.Views.NewPostView},yourPhotos:function(){$(".main-section").empty();var e=new Parse.Query(App.Models.Photo);e.equalTo("photographer",Parse.User.current());var t=e.collection();t.fetch(),new App.Views.YourPhotosView({collection:t,model:App.Models.Photo})},userphotos:function(){$(".main-section").empty();var e=new Parse.Query("User");e.equalTo("username",username);var t=new Parse.Query("Photo");t.matchesQuery("photographer",userQ);t.collection()},allPics:function(){$(".main-section").empty();var e=new Parse.Query(App.Models.Photo),t=e.collection();t.fetch().then(function(){console.log(t),new App.Views.allPicsView({model:App.Models.Photos,collection:t})})}}),App.Views.CreateAccountView=Parse.View.extend({tagName:"form",className:"create-form",template:_.template($("#templates-create-account").text()),events:{"click .button":"createAccount"},createAccount:function(e){e.preventDefault();var t=new Parse.User;t.set("email",$(".email").val()),t.set("username",$(".username").val()),t.set("password",$(".password").val()),t.signUp(null,{success:function(){Parse.User.logIn($(".username").val(),$(".password").val(),{success:function(){App.Route.navigate("yourPhotos",{trigger:!0}),console.log("user created!")},error:function(){App.Route.navigate("login",{trigger:!0})}})},error:function(){alert("error: "+error.code+" "+error.message)}})},initialize:function(){$(".main-section").append(this.el),this.render()},render:function(){this.$el.html(this.template)}}),App.Views.LoginView=Parse.View.extend({tagName:"form",className:"login-form",template:_.template($("#templates-login").text()),events:{"click .button":"login"},login:function(e){e.preventDefault(),Parse.User.logIn($(".username").val(),$(".password").val(),{success:function(){App.Route.navigate("yourPhotos",{trigger:!0})},error:function(e,t){console.log(t)}})},initialize:function(){$(".main-section").append(this.el),this.render()},render:function(){this.$el.html(this.template)}}),App.Views.LogoutView=Parse.View.extend({initialize:function(){Parse.User.logOut(),this.render()},render:function(){App.Route.navigate("login",{trigger:!0})}}),App.Views.NewPostView=Parse.View.extend({tagName:"form",className:"post-form",template:_.template($("#templates-new-post").text()),events:{"click .button":"save"},save:function(e){var t=this;e.preventDefault();var o=$(".upload-image")[0];if(o.files.length>0){var n=o.files[0],i=new Parse.File(n.name,n);i.save().then(function(){t.model.set("image",i.url()),t.model.set({photographer:Parse.User.current()}),t.model.save(null,{success:function(){App.Route.navigate("yourPhotos",{trigger:!0})},error:function(e,t){alert("failed: "+t.message)}})})}},initialize:function(){this.model=new App.Models.Photo,$(".main-section").append(this.el),this.render()},render:function(){this.$el.append(this.template)}}),App.Views.YourPhotosView=Parse.View.extend({tagName:"ul",className:"your-images",template:_.template($("#templates-your-photo-header").text()),initialize:function(){$(".main-section").append(this.el),this.render(),this.collection.on("reset",this.render,this)},render:function(){this.$el.prepend(this.template),this.collection.each(this.renderChildren,this)},renderChildren:function(e){new App.Views.YourView({model:e})}}),App.Views.YourView=Parse.View.extend({tagName:"li",className:"image",template:_.template($("#templates-your-photos").text()),initialize:function(){$(".your-images").append(this.el),this.render()},render:function(){this.$el.append(this.template({photo:this.model.toJSON()}))}}),App.Views.allPicsView=Parse.View.extend({template:_.template($("#templates-all-pics").text()),className:"all-pics",initialize:function(){$(".main-section").append(this.el),this.render()},render:function(){console.log(this.collection.models),this.$el.append(this.template(this.collection))}}),$(document).ready(function(){Parse.initialize("vVC1xm387FRV3TVHQF0hYaSBIFuThELIf74SnM7K","6caMAmTXeoGZSP0oQWD3H22QfAK4Sjl1QU5VBbtG"),App.Route=new App.Router,Parse.history.start()})}();